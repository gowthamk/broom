Recent work in high-performance systems written in managed languages (such as Java or C\#) has shown
that garbage-collection can become a significant performance bottleneck in such systems.
A class of these systems, which we refer to as dataflow programs, create huge data-structures with well-defined
lifetimes that open up the possibility for significant performance improvements by using alternative memory
management techniques that can exploit knowledge of these data-structures' lifetimes.

In this paper, we present a memory management scheme that uses user-managed
memory regions that allow programmers to exploit the specific memory behaviours exhibited by dataflow programs.
To protect programmers from the dangers of manual memory management, we
supplement our memory management scheme with a region type system that
statically ensures the memory safety of region-annotated C\# programs,
even in presence of higher-order stateful functions. Further, we
describe a type inference algorithm that infers principal region types
for first-order programs thereby saving programmers the need to write
region annotations on types. Our inference algorithm is also very
effective, albeit incomplete, for higher-order programs.

%As a testament to efficacy of our approach, we demonstrate performance
%improvements over a range of realistic dataflow programs that were
%rewritten to use region-based manual memory management, but are
%nevertheless judged to be safe by our type system.