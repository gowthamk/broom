There is an increasing interest in alternative memory management
schemes that seek to combine the convenience of garbage collection and
the performance of manual memory management in a single language
framework.  Unfortunately, ensuring safety in presence of manual
memory management remains as great a challenge as ever. In this paper,
we present a C\#-like object-oriented language called {\sc
Broom}\xspace that uses a combination of region type system and
lightweight runtime checks to enforce safety in presence of
user-managed memory regions called \emph{transferable regions}. Unsafe
transferable regions have been previously used to contain the latency
due to unbounded GC pauses. Our approach shows that it is possible to
restore safety without compromising on the benefits of transferable
regions.  We prove the type safety of {\sc Broom}\xspace in a formal
framework that includes its C\#-inspired features, such as
higher-order functions and generics. We complement our type system
with a type inference algorithm, which eliminates the need for
programmers to write region annotations on types. The inference
algorithm has been proven sound and relatively complete. We describe a
prototype implementation of the inference algorithm, and our
experience of using it to enforce memory safety in dataflow programs.
% %
% In this paper, we present a language and a memory management scheme based
% on user-managed memory regions (called \emph{transferable regions})
% that allow programmers to exploit knowledge of data structures' lifetimes
% to improve performance.

% Manual memory management is susceptible to the usual perils of
% dangling pointers. A key contribution of this paper is a
% refinement-based region type system, for a C\#-like typed
% object-oriented language with higher-order functions and generics,
% that ensures the memory safety of programs in the presence of
% transferable regions.  
